# Mood Tracker ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ - ç¾åœ¨ã®çŠ¶æ³ã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å**: Mood Tracker - AIã‚’æ´»ç”¨ã—ãŸèª¿å­è¨˜éŒ²ã‚¢ãƒ—ãƒª

**ç›®çš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ—¥ã€…ã®èª¿å­ã‚’è¨˜éŒ²ã—ã€AIã«ã‚ˆã‚‹åˆ†æžã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’å—ã‘ã‚‹ã“ã¨ã§ã€è‡ªå·±ç†è§£ã‚’æ·±ã‚ã€ã‚ˆã‚Šè‰¯ã„ç”Ÿæ´»ç¿’æ…£ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’æ”¯æ´ã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

**ä¸»è¦æ©Ÿèƒ½**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ï¼ˆç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ï¼‰
- èª¿å­ãƒ‡ãƒ¼ã‚¿ã®è¨˜éŒ²ï¼ˆä½“èª¿ã€æ°—åˆ†ã€æ´»å‹•å†…å®¹ãªã©ï¼‰
- è‡ªå·±åˆ†æžè³ªå•ã¸ã®å›žç­”ï¼ˆ10æ®µéšŽè©•ä¾¡ï¼‰
- æ°—è±¡ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•å–å¾—ãƒ»è¨˜éŒ²
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ï¼ˆã‚°ãƒ©ãƒ•è¡¨ç¤ºï¼‰
- è¨˜éŒ²ã®ä¸€è¦§è¡¨ç¤ºãƒ»è©³ç´°è¡¨ç¤º
- AIã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†æžã¨ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆï¼ˆä»Šå¾Œå®Ÿè£…äºˆå®šï¼‰

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- React 18.x
- TypeScript 5.x
- Vite 5.x
- Axios 1.x
- Chart.js 4.x
- React Icons 5.x

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- Node.js 20.x LTS
- Express 4.x
- TypeScript 5.x
- pg (node-postgres) 8.x
- bcrypt 5.x
- jsonwebtoken 9.x
- express-validator 7.x
- dotenv 16.x

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- PostgreSQL 16.x

### å¤–éƒ¨API
- WeatherAPIï¼ˆæ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼‰
- Google Gemini APIï¼ˆAIåˆ†æžãƒ»ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ - ä»Šå¾Œå®Ÿè£…äºˆå®šï¼‰

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

### å®Ÿéš›ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ**: `E:\ReactProject\`

```
E:\ReactProject\
â”œâ”€â”€ mood-tracker-api/        # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â””â”€â”€ database.ts
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ authController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ recordController.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ analysisController.ts
â”‚   â”‚   â”‚   â””â”€â”€ weatherController.ts
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ User.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ Record.ts          # â˜…æœ€æ–°ä¿®æ­£
â”‚   â”‚   â”‚   â”œâ”€â”€ Analysis.ts
â”‚   â”‚   â”‚   â””â”€â”€ WeatherData.ts
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ authRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ recordRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ analysisRoutes.ts
â”‚   â”‚   â”‚   â””â”€â”€ weatherRoutes.ts
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”‚   â””â”€â”€ validation.ts
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ weatherService.ts
â”‚   â”‚   â”‚   â””â”€â”€ aiService.ts (äºˆå®š)
â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â””â”€â”€ mood-tracker-app/           # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/
    â”‚   â”‚   â”œâ”€â”€ Layout/
    â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.tsx
    â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx
    â”‚   â”‚   â”œâ”€â”€ charts/
    â”‚   â”‚   â”‚   â”œâ”€â”€ MoodChart.tsx      # â˜…æœ€æ–°ä¿®æ­£
    â”‚   â”‚   â”‚   â””â”€â”€ WeatherChart.tsx   # â˜…æœ€æ–°ä¿®æ­£
    â”‚   â”‚   â”œâ”€â”€ Dashboard/
    â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
    â”‚   â”‚   â”‚   â””â”€â”€ Dashboard.css
    â”‚   â”‚   â”œâ”€â”€ Record/
    â”‚   â”‚   â”‚   â”œâ”€â”€ RecordForm.tsx
    â”‚   â”‚   â”‚   â”œâ”€â”€ RecordForm.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ RecordList.tsx
    â”‚   â”‚   â”‚   â”œâ”€â”€ RecordList.css
    â”‚   â”‚   â”‚   â”œâ”€â”€ RecordDetail.tsx
    â”‚   â”‚   â”‚   â””â”€â”€ RecordDetail.css
    â”‚   â”‚   â””â”€â”€ Auth/
    â”‚   â”‚       â”œâ”€â”€ Login.tsx
    â”‚   â”‚       â””â”€â”€ Register.tsx
    â”‚   â”œâ”€â”€ services/
    â”‚   â”‚   â”œâ”€â”€ api.ts
    â”‚   â”‚   â”œâ”€â”€ authService.ts
    â”‚   â”‚   â”œâ”€â”€ recordService.ts
    â”‚   â”‚   â””â”€â”€ weatherService.ts
    â”‚   â”œâ”€â”€ types/
    â”‚   â”‚   â””â”€â”€ index.ts
    â”‚   â”œâ”€â”€ App.tsx
    â”‚   â””â”€â”€ main.tsx
    â”œâ”€â”€ package.json
    â””â”€â”€ vite.config.ts
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼ˆä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

### users
- id, username, email, password_hash, created_at, updated_at

### records
- id, user_id, recorded_at
- sleep_hours, sleep_quality
- meal_quality, meal_regularity
- exercise_minutes, exercise_intensity
- emotion_score, emotion_note
- motivation_score, activities_done
- created_at, updated_at

### weather_data
- id, user_id, recorded_at
- temperature, humidity, pressure
- weather_condition, weather_description
- season, location, api_source
- created_at

### analysis_categories
- id, code, name, description, created_at

### analysis_questions
- id, category_id, question_text
- is_active, generated_by_ai, usage_count
- created_at

### analysis_answers
- id, user_id, record_id, question_id
- answer_score, answered_at

### advice_history
- id, user_id, advice_text, advice_type
- based_on_data (JSONB)
- created_at, displayed_at, was_helpful

---

## API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

### èªè¨¼é–¢é€£
- `POST /api/auth/register` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
- `POST /api/auth/login` - ãƒ­ã‚°ã‚¤ãƒ³
- `GET /api/auth/me` - ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—

### è¨˜éŒ²é–¢é€£
- `GET /api/records` - è¨˜éŒ²ä¸€è¦§å–å¾—
- `GET /api/records/:id` - ç‰¹å®šã®è¨˜éŒ²å–å¾—
- `POST /api/records` - è¨˜éŒ²ä½œæˆ
- `PUT /api/records/:id` - è¨˜éŒ²æ›´æ–°
- `DELETE /api/records/:id` - è¨˜éŒ²å‰Šé™¤
- `GET /api/records/stats` - çµ±è¨ˆæƒ…å ±å–å¾—
- `GET /api/records/chart` - ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæ™‚é–“å˜ä½é›†ç´„ï¼‰

### åˆ†æžé–¢é€£
- `GET /api/analysis/categories` - åˆ†æžè¦³ç‚¹ä¸€è¦§å–å¾—
- `GET /api/analysis/questions` - è³ªå•ä¸€è¦§å–å¾—
- `POST /api/analysis/answers` - å›žç­”ä¿å­˜

### æ°—è±¡ãƒ‡ãƒ¼ã‚¿é–¢é€£
- `GET /api/weather/current` - ç¾åœ¨ã®æ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—
- `GET /api/weather/record/:recordId` - è¨˜éŒ²ã«ç´ã¥ãæ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—

---

## å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

### âœ… å®Œå…¨å®Ÿè£…æ¸ˆã¿

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã‚·ã‚¹ãƒ†ãƒ **
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³
   - JWTèªè¨¼
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcryptï¼‰

2. **è¨˜éŒ²ç®¡ç†æ©Ÿèƒ½**
   - è¨˜éŒ²ã®CRUDæ“ä½œ
   - çµ±è¨ˆæƒ…å ±å–å¾—
   - **ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆæ™‚é–“å˜ä½ã§é›†ç´„ã€å¹³å‡å€¤è¨ˆç®—ï¼‰** â˜…æœ€æ–°æ”¹å–„

3. **æ°—è±¡ãƒ‡ãƒ¼ã‚¿é€£æº**
   - WeatherAPIã‹ã‚‰ã®è‡ªå‹•å–å¾—
   - è¨˜éŒ²ä½œæˆæ™‚ã®è‡ªå‹•ä¿å­˜
   - ç¾åœ¨ã®æ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—API
   - è¨˜éŒ²ã«ç´ã¥ãæ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—API

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
1. **èªè¨¼ç”»é¢**
   - ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ç”»é¢

2. **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**
   - çµ±è¨ˆãƒ‘ãƒãƒ«ï¼ˆç·è¨˜éŒ²æ•°ã€ä»Šé€±ã®è¨˜éŒ²æ•°ã€å¹³å‡æ°—åˆ†ã€å¹³å‡ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
   - **ã‚°ãƒ©ãƒ•è¡¨ç¤ºï¼ˆæ°—åˆ†ãƒ»ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã€æ°—æ¸©ãƒ»æ¹¿åº¦ï¼‰** â˜…æœ€æ–°æ”¹å–„
     - æ™‚é–“å˜ä½ã§ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„è¡¨ç¤º
     - æ¨ªè»¸ãƒ©ãƒ™ãƒ«ï¼šMM/DD HH:00å½¢å¼
     - ãƒžã‚¦ã‚¹ãƒ›ãƒãƒ¼ã§è¿‘ã„å€¤ã‚’è‡ªå‹•è¡¨ç¤º
     - æ°—æ¸©è»¸ã®å‹•çš„ç¯„å›²èª¿æ•´
   - æœ€è¿‘ã®è¨˜éŒ²è¡¨ç¤º
   - ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

3. **è¨˜éŒ²å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ **
   - ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å…¥åŠ›ã«ã‚ˆã‚‹ã‚¹ã‚³ã‚¢è¨­å®š
   - æ°—è±¡æƒ…å ±ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤º
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
   - æˆåŠŸãƒ»ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

4. **è¨˜éŒ²ä¸€è¦§**
   - ã‚«ãƒ¼ãƒ‰å½¢å¼ã§ã®è¡¨ç¤º
   - è©³ç´°ç”»é¢ã¸ã®é·ç§»

5. **è¨˜éŒ²è©³ç´°**
   - å…¨è¨˜éŒ²ãƒ‡ãƒ¼ã‚¿ã®è¡¨ç¤º
   - ã‚¹ã‚³ã‚¢ã®ãƒãƒ¼å½¢å¼è¡¨ç¤º
   - æ°—è±¡æƒ…å ±ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤ºï¼ˆä¿å­˜æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ï¼‰
   - ä¸€è¦§ã¸æˆ»ã‚‹æ©Ÿèƒ½

6. **ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**
   - ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼
   - ãƒšãƒ¼ã‚¸é·ç§»æ©Ÿèƒ½
   - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

---

## æœ€æ–°å®Ÿè£…å†…å®¹ï¼ˆ2025/11/14ï¼‰

### ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½ã®æ”¹å–„

#### å®Ÿè£…æ¦‚è¦
ã‚°ãƒ©ãƒ•ã®ãƒ—ãƒ­ãƒƒãƒˆã‚’åˆ†å˜ä½ã‹ã‚‰æ™‚é–“å˜ä½ã«å¤‰æ›´ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„ã—ã¦è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®è¤‡æ•°ã®æ”¹å–„ã‚’å®Ÿæ–½ã€‚

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å¤‰æ›´

**Record.ts** (`E:\ReactProject\mood-tracker-api\src\models\Record.ts`)

1. **getChartData()ãƒ¡ã‚½ãƒƒãƒ‰**
   - `DATE_TRUNC('hour', recorded_at)` ã§æ™‚é–“å˜ä½ã«é›†ç´„
   - `ROUND(AVG()::numeric, 1)` ã§å¹³å‡å€¤ã‚’è¨ˆç®—
   - `TO_CHAR()` ã§æ—¥æ™‚ã‚’ `'MM/DD HH24:00'` å½¢å¼ã§è¿”å´
   - ç•°ãªã‚‹å¹´ã®åŒã˜æ—¥æ™‚ãƒ‡ãƒ¼ã‚¿ã‚‚æ­£ã—ãåŒºåˆ¥ã•ã‚Œã‚‹

2. **getWeatherChartData()ãƒ¡ã‚½ãƒƒãƒ‰**
   - åŒæ§˜ã«æ™‚é–“å˜ä½ã§é›†ç´„
   - `MODE() WITHIN GROUP (ORDER BY ...)` ã§å¤©æ°—ã®æœ€é »å€¤ã‚’å–å¾—
   - æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã‚’çµ±ä¸€

**SQLã‚¯ã‚¨ãƒªã®æ”¹å–„ç‚¹**:
```sql
-- ä¿®æ­£å‰
DATE(recorded_at), EXTRACT(HOUR FROM recorded_at)

-- ä¿®æ­£å¾Œ
DATE_TRUNC('hour', recorded_at)
TO_CHAR(DATE_TRUNC('hour', recorded_at), 'MM/DD HH24:00')
```

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å¤‰æ›´

**MoodChart.tsx** (`E:\ReactProject\mood-tracker-app\src\components\charts\MoodChart.tsx`)

1. **ã‚³ãƒ¼ãƒ‰ã®ç°¡ç´ åŒ–**
   - è¤‡é›‘ãªæ—¥ä»˜ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‰Šé™¤ï¼ˆ100è¡Œä»¥ä¸Šå‰Šæ¸›ï¼‰
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰è¿”ã•ã‚Œã‚‹æ™‚é–“å˜ä½ã®æ—¥æ™‚ã‚’ãã®ã¾ã¾ä½¿ç”¨
   - Chart.jsã®æ¨™æº–çš„ãªä½¿ã„æ–¹ã«å¤‰æ›´

2. **CategoryScaleã®è¿½åŠ **
   - Chart.jsã®ã‚«ãƒ†ã‚´ãƒªè»¸ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«å¿…é ˆ
   - `import { CategoryScale } from 'chart.js'`
   - `ChartJS.register(CategoryScale, ...)`

3. **ãƒ›ãƒãƒ¼å‹•ä½œã®æ”¹å–„**
   - `interaction: { mode: 'index', intersect: false }` ã‚’è¿½åŠ 
   - ã‚°ãƒ©ãƒ•ä¸Šã®ã©ã“ã§ã‚‚ãƒžã‚¦ã‚¹ãƒ›ãƒãƒ¼ã§å€¤ã‚’è¡¨ç¤º
   - WeatherChartã¨åŒã˜å‹•ä½œã«çµ±ä¸€

**WeatherChart.tsx** (`E:\ReactProject\mood-tracker-app\src\components\charts\WeatherChart.tsx`)

1. **ã‚³ãƒ¼ãƒ‰ã®ç°¡ç´ åŒ–**
   - MoodChartã¨åŒæ§˜ã«ç°¡ç´ åŒ–
   - CategoryScaleã‚’è¿½åŠ 

2. **æ°—æ¸©è»¸ã®å‹•çš„ç¯„å›²èª¿æ•´æ©Ÿèƒ½** â˜…æ–°æ©Ÿèƒ½
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š0åº¦ï½ž40åº¦
   - ãƒ‡ãƒ¼ã‚¿ãŒ0åº¦ã‚’ä¸‹å›žã‚‹å ´åˆï¼šæœ€å°å€¤ã‚’10ã®å€æ•°ã«åˆ‡ã‚Šä¸‹ã’
   - ãƒ‡ãƒ¼ã‚¿ãŒ40åº¦ã‚’ä¸Šå›žã‚‹å ´åˆï¼šæœ€å¤§å€¤ã‚’10ã®å€æ•°ã«åˆ‡ã‚Šä¸Šã’
   - ç¯„å›²ã«å¿œã˜ã¦é–“éš”ã‚’è‡ªå‹•èª¿æ•´ï¼ˆ2åº¦/5åº¦/10åº¦ï¼‰

**å‹•çš„ç¯„å›²èª¿æ•´ã®å®Ÿè£…**:
```typescript
const validTemperatures = temperatures.filter((t): t is number => t !== null && t !== undefined);
let tempMin = 0;
let tempMax = 40;
let tempStepSize = 5;

if (validTemperatures.length > 0) {
  const dataMin = Math.min(...validTemperatures);
  const dataMax = Math.max(...validTemperatures);

  if (dataMin < 0) {
    tempMin = Math.floor(dataMin / 10) * 10;
  }
  if (dataMax > 40) {
    tempMax = Math.ceil(dataMax / 10) * 10;
  }

  const range = tempMax - tempMin;
  if (range <= 20) {
    tempStepSize = 2;
  } else if (range <= 40) {
    tempStepSize = 5;
  } else {
    tempStepSize = 10;
  }
}
```

#### æ”¹å–„ã®åŠ¹æžœ

**è¡¨ç¤ºå½¢å¼**:
- æ¨ªè»¸ãƒ©ãƒ™ãƒ«ï¼š`11/14 13:00` ã®ã‚ˆã†ã«å¹´ã‚’çœç•¥ã—ã¦è¡¨ç¤º
- ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ï¼š`MM/DD HH:00` å½¢å¼ã§æ—¥æ™‚ã‚’æ˜Žç¢ºã«è¡¨ç¤º
- æ°—æ¸©ï¼šé©åˆ‡ãªç¯„å›²ã¨é–“éš”ã§è¦‹ã‚„ã™ãè¡¨ç¤º

**ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£**:
- ãƒ‡ãƒ¼ã‚¿ãŒæ™‚é–“å˜ä½ã§é›†ç´„ã•ã‚Œã€è¦‹ã‚„ã™ããªã£ãŸ
- ã‚°ãƒ©ãƒ•ä¸Šã®ã©ã“ã§ã‚‚ãƒžã‚¦ã‚¹ãƒ›ãƒãƒ¼ã§å€¤ã‚’ç¢ºèªã§ãã‚‹
- æ°—æ¸©ç¯„å›²ãŒãƒ‡ãƒ¼ã‚¿ã«å¿œã˜ã¦è‡ªå‹•èª¿æ•´ã•ã‚Œã‚‹

**ãƒ‡ãƒ¼ã‚¿ç²¾åº¦**:
- åŒã˜æ™‚åˆ»ã®è¤‡æ•°è¨˜éŒ²ã¯å¹³å‡å€¤ã¨ã—ã¦è¡¨ç¤º
- ç•°ãªã‚‹å¹´ã®åŒã˜æ—¥æ™‚ãƒ‡ãƒ¼ã‚¿ã¯æ­£ã—ãåŒºåˆ¥ã•ã‚Œã‚‹
- å¤©æ°—ã®çŠ¶æ…‹ã¯æœ€é »å€¤ã‚’è¡¨ç¤º

---

## æœªå®Ÿè£…ãƒ»ä»Šå¾Œã®å®Ÿè£…äºˆå®š

### ðŸ”² éƒ¨åˆ†å®Ÿè£…ãƒ»è¦æ”¹å–„

1. **è‡ªå·±åˆ†æžæ©Ÿèƒ½**
   - ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: analysisController, analysisRoutesï¼ˆæœªç¢ºèªï¼‰
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: AnalysisFormã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆæœªç¢ºèªï¼‰
   - è³ªå•ã®è¡¨ç¤ºã¨å›žç­”ä¿å­˜æ©Ÿèƒ½

2. **è¨˜éŒ²ç·¨é›†æ©Ÿèƒ½**
   - ç·¨é›†ç”»é¢ï¼ˆæœªå®Ÿè£…ï¼‰
   - updateRecord APIã¯å®Ÿè£…æ¸ˆã¿

### ðŸ”² æœªå®Ÿè£…

1. **AIåˆ†æžãƒ»ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ©Ÿèƒ½**
   - aiService.tsï¼ˆæœªå®Ÿè£…ï¼‰
   - Gemini APIé€£æº
   - ãƒ‡ãƒ¼ã‚¿åˆ†æž
   - ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
   - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹è¡¨ç¤º

2. **ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½**
   - CSVå‡ºåŠ›
   - PDFå‡ºåŠ›

3. **é€šçŸ¥æ©Ÿèƒ½**
   - è¨˜éŒ²ãƒªãƒžã‚¤ãƒ³ãƒ€ãƒ¼
   - å®šæœŸçš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹é…ä¿¡

4. **æ°—è±¡ãƒ‡ãƒ¼ã‚¿ã¨ä½“èª¿ã®ç›¸é–¢åˆ†æž**
   - è©³ç´°ãªç›¸é–¢åˆ†æžæ©Ÿèƒ½
   - çµ±è¨ˆçš„ãªå‚¾å‘åˆ†æž

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®æŒ‡ç¤ºã¨ãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### é–‹ç™ºç’°å¢ƒ
- OS: Windows 11 24H2
- ã‚¨ãƒ‡ã‚£ã‚¿: VSCode
- ç„¡å„Ÿãƒ„ãƒ¼ãƒ«ã®ã¿ä½¿ç”¨
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹: `E:\ReactProject\`

### å­¦ç¿’ãƒ»é–‹ç™ºã‚¹ã‚¿ã‚¤ãƒ«
- æ©Ÿèƒ½å˜ä½ã§å­¦ç¿’ã‚’é€²ã‚ã‚‹
- æ®µéšŽçš„ãªèª¬æ˜ŽãŒé©åˆ‡ãªå ´åˆã¯æ®µéšŽçš„ã«
- 1å›žã‚ãŸã‚Š45åˆ†ã§å®Œäº†ã™ã‚‹ãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒæœ›ã¾ã—ã„

### è¨€èªžãƒ»æŠ€è¡“çµŒé¨“
- JavaScript: æ–‡æ³•ç†è§£ã€DOMæ“ä½œå¯èƒ½
- TypeScript: æ¥­å‹™ã§ä½¿ç”¨ã€JavaScriptåŒç­‰ã®ç†è§£
- Node.js/npm: ä½¿ç”¨çµŒé¨“ãªã— â†’ ä»Šå›žå­¦ç¿’ä¸­
- HTML/CSS: åŸºæœ¬çŸ¥è­˜ã‚ã‚Š
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: C# Web APIçµŒé¨“ã‚ã‚Šï¼ˆå†…å®¹æ›–æ˜§ï¼‰

### å›žç­”å½¢å¼ã®ãƒ—ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹
- å£èª¿: ãƒ“ã‚¸ãƒã‚¹ä¸å¯§åž‹ï¼ˆä¼šè©±ãƒ»èª¬æ˜Žæ™‚ï¼‰ã€å­¦è¡“ãƒ»è§£èª¬åž‹ï¼ˆæ–‡ç« ä½œæˆæ™‚ï¼‰
- å‡ºåŠ›å½¢å¼: æ®µè½åž‹ã‚’åŸºæœ¬ã€ç®‡æ¡æ›¸ãã‚„è¡¨ã¯å¿…è¦æœ€ä½Žé™
- é•·ã•: è©³ç´°ã§é•·ã‚ã®æ–‡ç« ã‚’å¥½ã‚€
- æ¯”å–©: ä½¿ã‚ãªã„ã€äº‹å®Ÿã‚„æ¦‚å¿µã‚’ãã®ã¾ã¾èª¬æ˜Ž
- æ§‹æˆ: åˆå­¦è€…å‘ã‘ã¯ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—åž‹ã€è³‡æ–™ä½œæˆã¯ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³åž‹
- æ›–æ˜§æ€§: æŽ¨æ¸¬ã›ãšè³ªå•ã—ã¦ç¢ºèª
- æ˜Žç¢ºãªç«‹å ´: è³›å¦ä¸¦åˆ—ã‚’é¿ã‘ã€æ˜Žç¢ºãªæ–¹å‘æ€§ã‚’ç¤ºã™

---

## ç¾åœ¨ã®çŠ¶æ³

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹
âœ… **æ­£å¸¸ã«å‹•ä½œä¸­**

### ç›´å‰ã®ä½œæ¥­ï¼ˆ2025/11/14ï¼‰
ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½ã®å¤§å¹…ãªæ”¹å–„ã‚’å®Ÿæ–½ã€‚æ™‚é–“å˜ä½ã§ã®ãƒ‡ãƒ¼ã‚¿é›†ç´„ã€è¡¨ç¤ºå½¢å¼ã®çµ±ä¸€ã€ãƒ›ãƒãƒ¼å‹•ä½œã®æ”¹å–„ã€æ°—æ¸©è»¸ã®å‹•çš„ç¯„å›²èª¿æ•´æ©Ÿèƒ½ã‚’å®Ÿè£…å®Œäº†ã€‚

### å®Ÿè£…å®Œäº†ã—ãŸæ©Ÿèƒ½
1. ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®æ™‚é–“å˜ä½é›†ç´„ï¼ˆåˆ†å˜ä½â†’æ™‚é–“å˜ä½ï¼‰
2. æ¨ªè»¸ãƒ©ãƒ™ãƒ«ã®å½¢å¼çµ±ä¸€ï¼ˆMM/DD HH:00ï¼‰
3. ãƒžã‚¦ã‚¹ãƒ›ãƒãƒ¼å‹•ä½œã®æ”¹å–„ï¼ˆintersect: falseï¼‰
4. æ°—æ¸©è»¸ã®å‹•çš„ç¯„å›²èª¿æ•´æ©Ÿèƒ½
5. CategoryScaleã®è¿½åŠ ï¼ˆChart.jsã‚¨ãƒ©ãƒ¼ä¿®æ­£ï¼‰

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—å€™è£œ

### å„ªå…ˆåº¦: é«˜
1. **è‡ªå·±åˆ†æžæ©Ÿèƒ½ã®å®Ÿè£…**
   - è³ªå•è¡¨ç¤ºç”»é¢
   - å›žç­”ä¿å­˜æ©Ÿèƒ½
   - ãƒ‡ãƒ¼ã‚¿åˆ†æžåŸºç›¤

### å„ªå…ˆåº¦: ä¸­
2. **AIåˆ†æžãƒ»ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ©Ÿèƒ½ã®å®Ÿè£…**
   - Gemini APIé€£æº
   - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆ
   - ã‚¢ãƒ‰ãƒã‚¤ã‚¹è¡¨ç¤ºUI

3. **è¨˜éŒ²ç·¨é›†æ©Ÿèƒ½ã®è¿½åŠ **
   - ç·¨é›†ç”»é¢å®Ÿè£…
   - æ›´æ–°APIå®Œæˆ

### å„ªå…ˆåº¦: ä½Ž
4. **ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½**
5. **é€šçŸ¥æ©Ÿèƒ½**
6. **ç›¸é–¢åˆ†æžæ©Ÿèƒ½ã®æ‹¡å¼µ**

---

## é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹

### ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå®šç¾©æ›¸
- `E:\ReactProject\èª¿å­è¨˜éŒ²ã‚¢ãƒ—ãƒª_ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå®šç¾©æ›¸.md`

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
- `E:\ReactProject\æ¬¡ã®ä¼šè©±ã®ãŸã‚ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ.md`ï¼ˆæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

### æœ€æ–°ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ2025/11/14ï¼‰

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**:
- `E:\ReactProject\mood-tracker-api\src\models\Record.ts`

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**:
- `E:\ReactProject\mood-tracker-app\src\components\charts\MoodChart.tsx`
- `E:\ReactProject\mood-tracker-app\src\components\charts\WeatherChart.tsx`

---

## æŠ€è¡“çš„ãªè£œè¶³æƒ…å ±

### ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®é›†ç´„ãƒ­ã‚¸ãƒƒã‚¯

**DATE_TRUNCé–¢æ•°ã®å‹•ä½œ**:
```sql
-- å…ƒã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—
2025-11-14 13:25:30 â†’ 2025-11-14 13:00:00
2025-11-14 13:45:00 â†’ 2025-11-14 13:00:00
2024-11-14 13:25:30 â†’ 2024-11-14 13:00:00ï¼ˆç•°ãªã‚‹å¹´ã¯åˆ¥ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰

-- GROUP BY ã§é›†ç´„
GROUP BY DATE_TRUNC('hour', recorded_at)
```

**å¹³å‡å€¤ã®è¨ˆç®—**:
- emotion_score, motivation_score: å°æ•°ç¬¬1ä½ã¾ã§
- temperature, humidity: å°æ•°ç¬¬1ä½ã¾ã§
- weather_condition: æœ€é »å€¤ï¼ˆMODEé–¢æ•°ï¼‰

### Chart.jsã®è¨­å®š

**å¿…é ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
- CategoryScale: ã‚«ãƒ†ã‚´ãƒªè»¸ï¼ˆlabelsé…åˆ—ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã«å¿…é ˆ
- LinearScale: æ•°å€¤è»¸
- PointElement, LineElement: æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•
- Tooltip, Legend: ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã¨ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰

**ãƒ›ãƒãƒ¼è¨­å®š**:
```typescript
interaction: {
  mode: 'index',      // xåº§æ¨™ã«æœ€ã‚‚è¿‘ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
  intersect: false,   // ãƒ—ãƒ­ãƒƒãƒˆç‚¹ã«æ­£ç¢ºã«ãƒ›ãƒãƒ¼ã—ãªãã¦ã‚‚OK
}
```

### æ°—æ¸©è»¸ã®ç¯„å›²æ±ºå®šãƒ­ã‚¸ãƒƒã‚¯

**è¨ˆç®—ä¾‹**:
- ãƒ‡ãƒ¼ã‚¿ç¯„å›²ï¼š10ï½ž30åº¦ â†’ è»¸ï¼š0ï½ž40åº¦ã€é–“éš”ï¼š5åº¦
- ãƒ‡ãƒ¼ã‚¿ç¯„å›²ï¼š-8ï½ž15åº¦ â†’ è»¸ï¼š-10ï½ž40åº¦ã€é–“éš”ï¼š5åº¦
- ãƒ‡ãƒ¼ã‚¿ç¯„å›²ï¼š30ï½ž45åº¦ â†’ è»¸ï¼š0ï½ž50åº¦ã€é–“éš”ï¼š5åº¦
- ãƒ‡ãƒ¼ã‚¿ç¯„å›²ï¼š-25ï½ž5åº¦ â†’ è»¸ï¼š-30ï½ž40åº¦ã€é–“éš”ï¼š10åº¦

---

## ä¼šè©±ã®å†é–‹æ™‚ã®æŒ‡ç¤º

æ¬¡ã®ä¼šè©±ã‚’é–‹å§‹ã™ã‚‹éš›ã¯ã€ä»¥ä¸‹ã‚’ä¼ãˆã¦ãã ã•ã„ï¼š

1. **æ¬¡ã«å®Ÿè£…ã—ãŸã„æ©Ÿèƒ½**
   - è‡ªå·±åˆ†æžæ©Ÿèƒ½
   - AIåˆ†æžãƒ»ã‚¢ãƒ‰ãƒã‚¤ã‚¹æ©Ÿèƒ½
   - è¨˜éŒ²ç·¨é›†æ©Ÿèƒ½
   - ãã®ä»–ã®æ”¹å–„

2. **ã¾ãŸã¯ã€ãã®ä»–ã®è³ªå•ãƒ»ç›¸è«‡**
   - æ—¢å­˜æ©Ÿèƒ½ã®æ”¹å–„
   - ãƒã‚°ä¿®æ­£
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„

---

## è£œè¶³æƒ…å ±

### éŽåŽ»ã®ä¼šè©±
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä»¥ä¸‹ã®ä¼šè©±ã®æµã‚Œã§é–‹ç™ºã•ã‚Œã¦ã„ã¾ã™ï¼š
1. ã€ŒReact and TypeScript web app learning planã€- ä¼ç”»ã¨æŠ€è¡“é¸å®š
2. ã€ŒReact and TypeScript learning roadmapã€- ReactåŸºç¤Žå­¦ç¿’
3. ã€ŒReact and TypeScript project documentationã€- ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå®šç¾©æ›¸ä½œæˆ
4. ã€ŒWeather data display modification for local MCP serverã€ - è¨˜éŒ²è©³ç´°ç”»é¢ã®æ°—è±¡ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ”¹å–„
5. ã€ŒGraph display improvements and temperature axis adjustmentã€ - ã‚°ãƒ©ãƒ•è¡¨ç¤ºæ©Ÿèƒ½ã®å¤§å¹…æ”¹å–„ï¼ˆæœ¬ä¼šè©±ï¼‰

### å‚è€ƒè³‡æ–™
- ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆå®šç¾©æ›¸ã«å…¨ä½“åƒã¨APIä»•æ§˜ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™
- æœ¬ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«æœ€æ–°ã®å®Ÿè£…çŠ¶æ³ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™

---

**æœ€çµ‚æ›´æ–°æ—¥**: 2025å¹´11æœˆ14æ—¥  
**ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚º**: å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º  
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: è‡ªå·±åˆ†æžæ©Ÿèƒ½ã®å®Ÿè£… ã¾ãŸã¯ ãã®ä»–ã®æ©Ÿèƒ½æ”¹å–„
